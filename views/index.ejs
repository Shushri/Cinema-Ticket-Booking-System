<!DOCTYPE html>
<html>
<head>
  <title>Movie Management System</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <h1>ðŸŽ¬ Movie Management System</h1>

  <% if (error) { %>
    <div class="error"><%= error %></div>
  <% } %>

  <!-- Table selection -->
  <form method="POST" action="/view">
    <select name="table" required>
      <option value="" disabled selected>Select a Table</option>
      <option value="Movies" <%= table === "Movies" ? "selected" : "" %>>Movies</option>
      <option value="Theaters" <%= table === "Theaters" ? "selected" : "" %>>Theaters</option>
      <option value="Showtimes" <%= table === "Showtimes" ? "selected" : "" %>>Showtimes</option>
      <option value="Bookings" <%= table === "Bookings" ? "selected" : "" %>>Bookings</option>
    </select>
    <button type="submit">View</button>
  </form>

  <% if (!table) { %>
    <p>Please select a table to view records.</p>
  <% } else { %>
    <% if (!data || data.length === 0) { %>
      <p>No records found in <b><%= table %></b> table.</p>
      <a href="/add/<%= table %>" class="add-btn">+ Add Record</a>
    <% } else { %>
      <h2><%= table %> Records</h2>
      <table>
        <thead>
          <tr>
            <% Object.keys(data[0]).forEach(col => { %>
              <th><%= col %></th>
            <% }) %>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% data.forEach(row => { %>
            <tr>
              <% Object.values(row).forEach(val => { %>
                <td><%= val %></td>
              <% }) %>
              <td>
                <a href="/edit/<%= table %>/<%= row[pk] %>" class="edit-btn">Edit</a>
                <form method="POST" action="/delete/<%= table %>/<%= row[pk] %>" style="display:inline;">
                  <button type="submit" class="delete-btn">Delete</button>
                </form>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>

      <a href="/add/<%= table %>" class="add-btn">+ Add Record</a>
    <% } %>
  <% } %>
</body>
</html>
